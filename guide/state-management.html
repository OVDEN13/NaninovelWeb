<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>State Management | Naninovel</title>
    <meta name="description" content="Unity-powered visual novel engine">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#4985c2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <meta name="google-site-verification" content="cdvgJ2XFFbaGErDKJtTbFj9u9frfReZ9rzUnsf9F6nI">
    
    <link rel="preload" href="/assets/css/0.styles.2221cc34.css" as="style"><link rel="preload" href="/assets/js/app.a0cb59a9.js" as="script"><link rel="preload" href="/assets/js/2.dc1e86ee.js" as="script"><link rel="preload" href="/assets/js/42.04b2acd2.js" as="script"><link rel="prefetch" href="/assets/js/10.7825c8cd.js"><link rel="prefetch" href="/assets/js/11.490428e0.js"><link rel="prefetch" href="/assets/js/12.32d8c3e8.js"><link rel="prefetch" href="/assets/js/13.2d3ff127.js"><link rel="prefetch" href="/assets/js/14.e2b1cb43.js"><link rel="prefetch" href="/assets/js/15.d489db1a.js"><link rel="prefetch" href="/assets/js/16.f513d059.js"><link rel="prefetch" href="/assets/js/17.021fe9bf.js"><link rel="prefetch" href="/assets/js/18.52489cf4.js"><link rel="prefetch" href="/assets/js/19.0da6302a.js"><link rel="prefetch" href="/assets/js/20.f5feee14.js"><link rel="prefetch" href="/assets/js/21.ebf499b2.js"><link rel="prefetch" href="/assets/js/22.170bc7b4.js"><link rel="prefetch" href="/assets/js/23.da314d42.js"><link rel="prefetch" href="/assets/js/24.c2a80588.js"><link rel="prefetch" href="/assets/js/25.531fe4a5.js"><link rel="prefetch" href="/assets/js/26.1abc014f.js"><link rel="prefetch" href="/assets/js/27.52453c70.js"><link rel="prefetch" href="/assets/js/28.d7063159.js"><link rel="prefetch" href="/assets/js/29.1d7dbb0b.js"><link rel="prefetch" href="/assets/js/3.9baad180.js"><link rel="prefetch" href="/assets/js/30.7db0950b.js"><link rel="prefetch" href="/assets/js/31.3065b8b1.js"><link rel="prefetch" href="/assets/js/32.1978fdaa.js"><link rel="prefetch" href="/assets/js/33.a2962125.js"><link rel="prefetch" href="/assets/js/34.e1932195.js"><link rel="prefetch" href="/assets/js/35.bbaefad4.js"><link rel="prefetch" href="/assets/js/36.719fc378.js"><link rel="prefetch" href="/assets/js/37.15f35983.js"><link rel="prefetch" href="/assets/js/38.c4fc0fae.js"><link rel="prefetch" href="/assets/js/39.6b489716.js"><link rel="prefetch" href="/assets/js/4.1e8453f6.js"><link rel="prefetch" href="/assets/js/40.e3e8551f.js"><link rel="prefetch" href="/assets/js/41.79a90e88.js"><link rel="prefetch" href="/assets/js/43.7af7a20a.js"><link rel="prefetch" href="/assets/js/44.ddd49b6d.js"><link rel="prefetch" href="/assets/js/45.f84f1a73.js"><link rel="prefetch" href="/assets/js/46.a7db4901.js"><link rel="prefetch" href="/assets/js/47.e7dced7a.js"><link rel="prefetch" href="/assets/js/48.57d57ce9.js"><link rel="prefetch" href="/assets/js/49.eb49329f.js"><link rel="prefetch" href="/assets/js/5.30314122.js"><link rel="prefetch" href="/assets/js/50.ca666e82.js"><link rel="prefetch" href="/assets/js/51.aaad81d2.js"><link rel="prefetch" href="/assets/js/52.051a7c11.js"><link rel="prefetch" href="/assets/js/53.75f58869.js"><link rel="prefetch" href="/assets/js/6.9283f851.js"><link rel="prefetch" href="/assets/js/7.c8c157ed.js"><link rel="prefetch" href="/assets/js/8.cfec70a9.js"><link rel="prefetch" href="/assets/js/9.936ac603.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2221cc34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Naninovel</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">News</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://twitter.com/naniengine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.facebook.com/naniengine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Facebook
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://forum.unity.com/threads/601966" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Unity Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://discord.gg/BfkNqem" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/faq/" class="nav-link">FAQ</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="/api/" class="nav-link">API Reference</a></div><div class="nav-item"><a href="/support/" class="nav-link">Support</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">News</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://twitter.com/naniengine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.facebook.com/naniengine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Facebook
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://forum.unity.com/threads/601966" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Unity Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://discord.gg/BfkNqem" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/faq/" class="nav-link">FAQ</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="/api/" class="nav-link">API Reference</a></div><div class="nav-item"><a href="/support/" class="nav-link">Support</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Guide</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Advanced</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/guide/development-console.html" class="sidebar-link">Development Console</a></li><li><a href="/guide/engine-architecture.html" class="sidebar-link">Engine Architecture</a></li><li><a href="/guide/engine-services.html" class="sidebar-link">Engine Services</a></li><li><a href="/guide/custom-commands.html" class="sidebar-link">Custom Commands</a></li><li><a href="/guide/custom-actor-implementations.html" class="sidebar-link">Custom Actor Implementations</a></li><li><a href="/guide/state-management.html" class="active sidebar-link">State Management</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/state-management.html#game-state" class="sidebar-link">Game State</a></li><li class="sidebar-sub-header"><a href="/guide/state-management.html#global-state" class="sidebar-link">Global State</a></li><li class="sidebar-sub-header"><a href="/guide/state-management.html#user-settings" class="sidebar-link">User Settings</a></li><li class="sidebar-sub-header"><a href="/guide/state-management.html#custom-state" class="sidebar-link">Custom State</a></li></ul></li><li><a href="/guide/integration-options.html" class="sidebar-link">Integration Options</a></li><li><a href="/guide/google-drive-integration.html" class="sidebar-link">Google Drive Integration</a></li><li><a href="/guide/custom-build-environment.html" class="sidebar-link">Custom Build Environment</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Extensions</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content default"><h1 id="state-management"><a href="#state-management" aria-hidden="true" class="header-anchor">#</a> State Management</h1> <p>All the persistent data generated and used by Naninovel at runtime is divided intro three categories:</p> <ul><li>Game state</li> <li>Global state</li> <li>User settings</li></ul> <p>The data is serialized to JSON format and stored as save slot <code>.json</code> text files on the file system under the game build directory. Under WebGL platform, due to LFS security policy in modern web-browsers, the serialized data is stored over the <a href="https://en.wikipedia.org/wiki/Indexed_Database_API" target="_blank" rel="noopener noreferrer">Indexed DB<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> instead.</p> <p>Path to the save folder, maximum allowed amount of the save slots and file names can be modified via the state configuration menu.</p> <p><img src="https://i.gyazo.com/01cf958545b590ab40ce19115938e4d7.png" alt=""></p> <h2 id="game-state"><a href="#game-state" aria-hidden="true" class="header-anchor">#</a> Game State</h2> <p>Game state is the data that varies per game save slot, describing state of the engine services and other objects in relation to the player progress with the game. The examples of the game state data are: currently played naninovel script and index of the played script command withing the script, currently visible characters and their positions on scene, currently played background music track name and its volume and so on.</p> <p>To save or load current game state to specific save slot, use <code>StateManager</code> engine service as follows:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Get instance of the state manager.</span>
<span class="token keyword">var</span> stateManager <span class="token operator">=</span> Engine<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetService</span><span class="token punctuation">&lt;</span><span class="token class-name">StateManager</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Save current game session to `mySaveSlot` slot.</span>
<span class="token keyword">await</span> stateManager<span class="token punctuation">.</span><span class="token function">SaveGameAsync</span><span class="token punctuation">(</span><span class="token string">&quot;mySaveSlot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Load game session from `mySaveSlot` slot.</span>
<span class="token keyword">await</span> stateManager<span class="token punctuation">.</span><span class="token function">LoadGameAsync</span><span class="token punctuation">(</span><span class="token string">&quot;mySaveSlot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// You can also use quick save-load methods without specifying the slot names.</span>
<span class="token keyword">await</span> stateManager<span class="token punctuation">.</span><span class="token function">QuickSaveAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> stateManager<span class="token punctuation">.</span><span class="token function">QuickLoadAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Notice, that the save-load API is <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/" target="_blank" rel="noopener noreferrer">asynchronous<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. In case you're invoking the API from synchronous methods, use <code>StateManager.OnGameSaveFinished</code> and <code>StateManager.OnGameLoadFinished</code> for subscribing to the completion events.</p> <h2 id="global-state"><a href="#global-state" aria-hidden="true" class="header-anchor">#</a> Global State</h2> <p>Some data, however, should be persistent across the game sessions. For example, &quot;Skip Read Text&quot; feature requires the engine to store data describing which naninovel script commands were executed at least once (meaning the player has already &quot;seen&quot; them). The data like this is stored in a single &quot;global&quot; save slot and doesn't depend on the game save-load operations.</p> <p>The global state is loaded automatically on engine initialization. You can save the global state at any time using <code>StateManager</code> as follows:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">await</span> stateManager<span class="token punctuation">.</span><span class="token function">SaveGlobalStateAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="user-settings"><a href="#user-settings" aria-hidden="true" class="header-anchor">#</a> User Settings</h2> <p>Similar to the global state, user settings data (display resolution, language, sound volume, etc) is stored in a single save slot, but treated a bit differently by default: the generated save file is placed outside of the &quot;Saves&quot; folder and formatted in a readable fashion, so that user can modify the values if he wishes.</p> <p>The user settings are loaded automatically on engine initialization. You can save the settings at any time using <code>StateManager</code> as follows:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">await</span> stateManager<span class="token punctuation">.</span><span class="token function">SaveSettingsAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="custom-state"><a href="#custom-state" aria-hidden="true" class="header-anchor">#</a> Custom State</h2> <p>It's possible to &quot;outsource&quot; state handling of your custom objects to the <code>StateManager</code>, so that they will serialize to the save slots with all the engine's data when player saves the game and deserialize back when the game is loaded.</p> <p>The following example demonstrates how to subscribe a generic <code>MonoBehaviour</code> to the save and load operations:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">using</span> UnityEngine<span class="token punctuation">;</span>
<span class="token keyword">using</span> Naninovel<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCustomBehaviour</span> <span class="token punctuation">:</span> <span class="token class-name">MonoBehaviour</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token class-name">System<span class="token punctuation">.</span>Serializable</span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">GameState</span> 
    <span class="token punctuation">{</span> 
    	<span class="token keyword">public</span> <span class="token keyword">bool</span> MyCustomBoolVariable<span class="token punctuation">;</span> 
    	<span class="token keyword">public</span> <span class="token keyword">string</span> MyCustomStringVariable<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">bool</span> myCustomBoolVariable<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">string</span> myCustomStringVariable<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">StateManager</span> stateManager<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> Awake <span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        stateManager <span class="token operator">=</span> Engine<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetService</span><span class="token punctuation">&lt;</span><span class="token class-name">StateManager</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> OnEnable <span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        stateManager<span class="token punctuation">.</span><span class="token function">AddOnGameSerializeTask</span><span class="token punctuation">(</span>SerializeState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stateManager<span class="token punctuation">.</span><span class="token function">AddOnGameDeserializeTask</span><span class="token punctuation">(</span>DeserializeState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> OnDisable <span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        stateManager<span class="token punctuation">.</span><span class="token function">RemoveOnGameSerializeTask</span><span class="token punctuation">(</span>SerializeState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stateManager<span class="token punctuation">.</span><span class="token function">RemoveOnGameDeserializeTask</span><span class="token punctuation">(</span>DeserializeState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Task</span> SerializeState <span class="token punctuation">(</span><span class="token class-name">GameStateMap</span> stateMap<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GameState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            MyCustomBoolVariable <span class="token operator">=</span> myCustomBoolVariable<span class="token punctuation">,</span>
            MyCustomStringVariable <span class="token operator">=</span> myCustomStringVariable
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        stateMap<span class="token punctuation">.</span><span class="token function">SetState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Task<span class="token punctuation">.</span>CompletedTask<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Task</span> DeserializeState <span class="token punctuation">(</span><span class="token class-name">GameStateMap</span> stateMap<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">var</span> state <span class="token operator">=</span> stateMap<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetState</span><span class="token punctuation">&lt;</span><span class="token class-name">GameState</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token keyword">is</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> Task<span class="token punctuation">.</span>CompletedTask<span class="token punctuation">;</span>

        myCustomBoolVariable <span class="token operator">=</span> state<span class="token punctuation">.</span>MyCustomBoolVariable<span class="token punctuation">;</span>
        myCustomStringVariable <span class="token operator">=</span> state<span class="token punctuation">.</span>MyCustomStringVariable<span class="token punctuation">;</span>
        <span class="token keyword">return</span> Task<span class="token punctuation">.</span>CompletedTask<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/guide/custom-actor-implementations.html" class="prev">
          Custom Actor Implementations
        </a></span> <span class="next"><a href="/guide/integration-options.html">
          Integration Options
        </a>
        →
      </span></p></div> </div></div><div class="global-ui"></div></div>
    <script src="/assets/js/2.dc1e86ee.js" defer></script><script src="/assets/js/42.04b2acd2.js" defer></script><script src="/assets/js/app.a0cb59a9.js" defer></script>
  </body>
</html>
